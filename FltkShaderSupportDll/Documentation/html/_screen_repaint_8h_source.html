<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FLTK Shader Support Library: ScreenRepaint.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FLTK Shader Support Library
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Extension of the FLTK Fl_Gl_Window to support OpenGL 3.0+ (shader) rendering using some utilities from the OpenGL SuperBible (5th Ed)</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ScreenRepaint.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#include &quot;DrawableObject.h&quot;</span>
<a name="l00003"></a>00003 
<a name="l00013"></a><a class="code" href="class_screen_repaint.html">00013</a> <span class="keyword">class </span><a class="code" href="class_screen_repaint.html" title="DrawableObject that takes a &#39;snapshot&#39; of what&#39;s been already been drawn and after processing...">ScreenRepaint</a> :
<a name="l00014"></a>00014         <span class="keyword">public</span> <a class="code" href="class_drawable_object.html" title="Base class for drawing an object in this framework. Extend to draw your own objects.">DrawableObject</a>
<a name="l00015"></a>00015 {
<a name="l00016"></a>00016 <span class="keyword">public</span>:
<a name="l00017"></a>00017 
<a name="l00031"></a>00031         <a class="code" href="class_screen_repaint.html#a71bcf622b5c4452b26d2b9f84243bfb1" title="Constructor.">ScreenRepaint</a>(GLuint activeTexture, <span class="keyword">const</span> <span class="keywordtype">char</span>* vertFileName, <span class="keyword">const</span> <span class="keywordtype">char</span>* fragFileName);
<a name="l00032"></a>00032 
<a name="l00041"></a>00041         <a class="code" href="class_screen_repaint.html#a751c2d2bd1e6134d28f7602957ee140b" title="Destructor.">~ScreenRepaint</a>(<span class="keywordtype">void</span>);
<a name="l00042"></a>00042 
<a name="l00054"></a>00054         <span class="keywordtype">void</span> <a class="code" href="class_screen_repaint.html#a6aac0dc8f8582386a39f2123e7723271" title="Resizes the screen-aligned quad and adjusts buffer memory.">resize</a>(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height);
<a name="l00055"></a>00055 
<a name="l00079"></a>00079         <span class="keywordtype">void</span> <a class="code" href="class_screen_repaint.html#a2d0707ffbfbfc21f54913437688fa075" title="Renders the quad. Note! THis should be called after all 3D drawing (i.e. after postDraw3D()), but before draw2D() The steps are as follows: First bind the PBO as the pack buffer, then read the pixels directly to the PBO and unbind Next bind the PBO as the unpack buffer, then push the pixels straight into the texture Setup texture unit for the render surface switch to the GL_TEXTURE* value that we are using as our screen texture holder write the pixels unbind Draw full screen quad with screen textures, calling setupScreenRenderProg() to access the chaders for the effect desired.">render</a>(GLMatrixStack &amp;modelViewStack, GLMatrixStack &amp;projectionStack, GLShaderManager &amp;shaderManager);
<a name="l00080"></a>00080 
<a name="l00089"></a>00089         <span class="keywordtype">void</span> <a class="code" href="class_screen_repaint.html#a983641dc820e4eabfb1e6b9a9966d82b" title="Environment calculation. In this case, do nothing.">environmentCalc</a>();
<a name="l00090"></a>00090 
<a name="l00102"></a>00102         <span class="keywordtype">void</span> <a class="code" href="class_screen_repaint.html#a1ef4b6395e8a5758663d57062de966fd" title="Make sure default FBO is bound Cleanup textures Delete detached textures Delete the pixel buffer...">localCleanup</a>();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="keyword">protected</span>:
<a name="l00105"></a>00105 
<a name="l00119"></a>00119         <span class="keywordtype">void</span> <a class="code" href="class_screen_repaint.html#a49e16becb8912de9898f6fd423289093" title="Initialises the frame buffer objects. If this is the first time this method is called, then the shader programs are read in and the texture and pixel buffer object handles are created and stored. Otherwise, if this is called as the result of a resize, a new ortho2D matrix is recalculated, and if the canvas is larger than previous sizes, the pixel buffer size is re-allocated.">ScreenRepaint::initFrameBufferObjects</a>();
<a name="l00120"></a>00120 
<a name="l00131"></a>00131         <span class="keywordtype">void</span> <a class="code" href="class_screen_repaint.html#a7b26ae89de772e886010fbbdaee0fbc6" title="Sets up the screen render shader programs.">setupScreenRenderProg</a>(<span class="keyword">const</span> M3DMatrix44f mat);
<a name="l00132"></a>00132 
<a name="l00137"></a><a class="code" href="class_screen_repaint.html#a547abbfc913fe100639bd66b350991db">00137</a>         GLsizei                         <a class="code" href="class_screen_repaint.html#a547abbfc913fe100639bd66b350991db">screenWidth</a>;                    <span class="comment">// Desired window or desktop width</span>
<a name="l00138"></a>00138 
<a name="l00143"></a><a class="code" href="class_screen_repaint.html#abac42d5d09d3f52c6e2567c524c03049">00143</a>         GLsizei                         <a class="code" href="class_screen_repaint.html#abac42d5d09d3f52c6e2567c524c03049">screenHeight</a>;                   <span class="comment">// Desired window or desktop height</span>
<a name="l00144"></a>00144 
<a name="l00149"></a><a class="code" href="class_screen_repaint.html#aa611aa789845c1503ac2fca30a992168">00149</a>         <span class="keywordtype">bool</span>                            <a class="code" href="class_screen_repaint.html#aa611aa789845c1503ac2fca30a992168">fboInitialized</a>;
<a name="l00150"></a>00150 
<a name="l00155"></a><a class="code" href="class_screen_repaint.html#acb9d4f9bbb2328a04e59833932b484f5">00155</a>         M3DMatrix44f        <a class="code" href="class_screen_repaint.html#acb9d4f9bbb2328a04e59833932b484f5">orthoMatrix</a>; 
<a name="l00156"></a>00156 
<a name="l00161"></a><a class="code" href="class_screen_repaint.html#a7052a5a8a1d72dcdff0268179a3f54ab">00161</a>         <span class="keywordtype">char</span>*                           <a class="code" href="class_screen_repaint.html#a7052a5a8a1d72dcdff0268179a3f54ab">vertexFileName</a>;
<a name="l00162"></a>00162 
<a name="l00167"></a><a class="code" href="class_screen_repaint.html#ac78e420a0c861ad17c63f5e0ac5473dc">00167</a>         <span class="keywordtype">char</span>*                           <a class="code" href="class_screen_repaint.html#ac78e420a0c861ad17c63f5e0ac5473dc">fragmentFileName</a>;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         <span class="comment">// fullscreen image processing</span>
<a name="l00170"></a>00170 
<a name="l00175"></a><a class="code" href="class_screen_repaint.html#a89572d6a5da58811afcf33c26d007dd9">00175</a>         GLuint                          <a class="code" href="class_screen_repaint.html#a89572d6a5da58811afcf33c26d007dd9">screenRenderProg</a>;
<a name="l00176"></a>00176 
<a name="l00181"></a><a class="code" href="class_screen_repaint.html#a0c691cfa0f3d656b02c019edf8944b6c">00181</a>         GLBatch             <a class="code" href="class_screen_repaint.html#a0c691cfa0f3d656b02c019edf8944b6c">screenQuad</a>;
<a name="l00182"></a>00182 
<a name="l00187"></a><a class="code" href="class_screen_repaint.html#affc1c0876ba5d8401938b166e6314e8c">00187</a>         GLuint                          <a class="code" href="class_screen_repaint.html#affc1c0876ba5d8401938b166e6314e8c">screenTextures</a>[1];
<a name="l00188"></a>00188 
<a name="l00193"></a><a class="code" href="class_screen_repaint.html#aed1d40b65dbb7b8fce5f8338c1900166">00193</a>         GLuint                          <a class="code" href="class_screen_repaint.html#aed1d40b65dbb7b8fce5f8338c1900166">pixBuffObjs</a>[1];
<a name="l00194"></a>00194 
<a name="l00199"></a><a class="code" href="class_screen_repaint.html#a4b009b422686af9594c19c777529ea49">00199</a>         GLuint                          <a class="code" href="class_screen_repaint.html#a4b009b422686af9594c19c777529ea49">pixelDataSize</a>;
<a name="l00200"></a>00200 
<a name="l00205"></a><a class="code" href="class_screen_repaint.html#afeebcd4de6dcc325a5fb59b154206823">00205</a>         GLuint                          <a class="code" href="class_screen_repaint.html#afeebcd4de6dcc325a5fb59b154206823">screenTextureID</a>;
<a name="l00206"></a>00206 
<a name="l00211"></a><a class="code" href="class_screen_repaint.html#a82bc1f48111a3e7a71abdd5dbce3b3e3">00211</a>         GLuint                          <a class="code" href="class_screen_repaint.html#a82bc1f48111a3e7a71abdd5dbce3b3e3">screenWidthLoc</a>;
<a name="l00212"></a>00212 
<a name="l00217"></a><a class="code" href="class_screen_repaint.html#a18d8432e475280b99a2cdb5786129011">00217</a>         GLuint                          <a class="code" href="class_screen_repaint.html#a18d8432e475280b99a2cdb5786129011">screenHeightLoc</a>;
<a name="l00218"></a>00218 };
<a name="l00219"></a>00219 
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 15 2012 14:44:59 for FLTK Shader Support Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
